# イメージビルド時に実行するタスク

# TODO: 本番環境では--no-dev
- name: composer install
  become: false
  composer:
    command: install
    working_dir: "{{ project_root }}"

# TODO: 本番環境では --production --pure-lockfileで実行する
- name: yarn install
  become: false
  shell: yarn install
  args:
    chdir: "{{ project_root }}"

# TODO: 本番環境では prod でビルドする
- name: build assets
  become: false
  shell: yarn dev
  args:
    chdir: "{{ project_root }}"
